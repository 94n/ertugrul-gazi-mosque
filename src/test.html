<!DOCTYPE html>
<html>
<head>
    <title></title>
</head>
<body>
<canvas id="canvas"></canvas>
<img id="canvasImg" alt="Right click to save me!">
<script type="text/javascript">
    var can = document.getElementById('canvas');
    var ctx = can.getContext('2d');
    var img = new Image();
    var diagonal;
    img.src = '4915172-lg.jpg';
    img.onload = function () {
        diagonal = Math.sqrt(Math.pow(img.width, 2) + Math.pow(img.height, 2));
        can.width = diagonal;
        can.height = diagonal;
        ctx.drawImage(img, (diagonal - img.width) / 2, (diagonal - img.height) / 2, img.width, img.height);
//        ctx.beginPath();
//        ctx.moveTo(170, 80);
//        ctx.bezierCurveTo(130, 100, 130, 150, 230, 150);
//        ctx.bezierCurveTo(250, 180, 320, 180, 340, 150);
//        ctx.bezierCurveTo(420, 150, 420, 120, 390, 100);
//        ctx.bezierCurveTo(430, 40, 370, 30, 340, 50);
//        ctx.bezierCurveTo(320, 5, 250, 20, 250, 50);
//        ctx.bezierCurveTo(200, 5, 150, 20, 170, 80);
//        ctx.closePath();
//        ctx.lineWidth = 5;
//        ctx.fillStyle = '#8ED6FF';
//        ctx.fill();
//        ctx.strokeStyle = '#0000ff';
//        ctx.stroke();
        document.getElementById('canvasImg').src = can.toDataURL('image/png');
//        Canvas2Image.saveAsBMP(can);
//        rotate();
    };

    function rotate() {
        ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
        var rotationCenter = diagonal / 2;
        ctx.translate(rotationCenter, rotationCenter);
        ctx.rotate(314 * Math.PI / 180);
        ctx.drawImage(img, -img.width / 2, -img.height / 2, img.width, img.height);
        ctx.restore();
    }

</script>
</body>
</html>